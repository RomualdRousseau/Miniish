; map

map_init
 phx
 phy
 ; init coin
 lda #18
 sta coin
 lda #8*8
 sta coin+$01
 lda #12*8
 sta coin+$02
 lda #0
 sta coin+$03
 ; copy map to ram
 lda #>data_start+$20
 sta src_ptr
 lda #$00
 sta src_ptr+1
 lda #>map_start
 sta dst_ptr
 lda #$00
 sta dst_ptr+1
 ldx #0
map_loop1
 ldy #0
map_loop2
 lda (src_ptr),y
 sta (dst_ptr),y
 iny
 bne map_loop2
 inc src_ptr
 inc dst_ptr
 inx
 cpx #4
 bne map_loop1
 ply
 plx
 rts

map_update
 lda counter
 and #15
 bne map_done
 lda coin
 clc
 adc #1
 cmp #20
 bne coin_next_anim
 lda #18
coin_next_anim
 sta coin
map_done
 rts
